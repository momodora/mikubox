<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>OpenAI API 密钥测试工具</title>
</head>
<body>
  <h2>OpenAI API 密钥有效性测试</h2>
  <label for="apiKey">输入你的 API 密钥：</label>
  <input type="text" id="apiKey" size="60" placeholder="sk-xxxxxxxxxxxxxxxxxxx">
  <button onclick="testAPIKey()">测试密钥</button>

  <pre id="result" style="background:#f0f0f0;padding:10px;margin-top:20px;"></pre>

  <script>
    async function testAPIKey() {
      const apiKey = document.getElementById('apiKey').value.trim();
      const resultBox = document.getElementById('result');
      if (!apiKey.startsWith('sk-')) {
        resultBox.textContent = "❌ 请输入正确格式的 OpenAI API 密钥。";
        return;
      }

      resultBox.textContent = "🔄 正在测试，请稍候...";

      try {
        const response = await fetch('https://api.openai.com/v1/models', {
          method: 'GET',
          headers: {
            'Authorization': 'Bearer ' + apiKey
          }
        });

        const data = await response.json();
        if (response.ok) {
          resultBox.textContent = "✅ 密钥有效！可用模型如下：\n\n" + 
            data.data.map(model => model.id).join('\n');
        } else {
          resultBox.textContent = "❌ 密钥无效或无权限。\n\n错误信息:\n" + JSON.stringify(data, null, 2);
        }
      } catch (err) {
        resultBox.textContent = "❌ 网络错误或请求失败：" + err.message;
      }
    }
  </script>
</body>
</html>
